language: python
python:
  - "2.7"
before_script:
  - psql -c 'create database penelope_travis;' -U postgres
  - bash travis-scripts/sauce_connect_setup.sh
install:
  - pip install --upgrade setuptools
  - python bootstrap.py -c .travis.cfg
  - bin/buildout -c .travis.cfg
script:
  - if [ "$BROWSER" != "code-analysis" ]; then export DESIRED_CAPABILITIES="$BROWSER,tunnel-identifier:$TRAVIS_JOB_NUMBER"; fi
  - if [ "$BROWSER" != "code-analysis" ]; then bin/test -m penelope.core.tests.test_robot; fi
  - if [ "$BROWSER" == "code-analysis" ]; then bin/py.test; fi
env: 
  global: 
  - secure: Ii0p4f02RWq6VCbVMLYSJrFt8ikpmgOMOphTqae7ArHYRBRImTXIH662SaBq2CYv4kJZcgzbStan9wpgsvCkrauGfywLdMu/nlhZXRqJf6MaedYg6yi4b9puHKRioeFNnNDM08PTg+itmiL0FFVH1gSMrgHFlbhRF8xPRXT0kTs=
  - secure: y5WwcywVrIMrqlnEjC1U9UhBjJ6YWZMKSTeXN2E+QAJreIsX+iOABh+3evbDF7LC5CZzLD+HsYe1xYAM/LZxAAA1NDxGYbdgHdjZZY2u9w9Ic1QB+SXb1vCPYr5agokBJPax+asrOwNSFVafEYzWd3G9ooDVb6YAvf0VVOeYTf8=
  - REMOTE_URL=http://$SAUCE_USERNAME:$SAUCE_ACCESS_KEY@ondemand.saucelabs.com:80/wd/hub
  matrix:
  - BROWSER="code-analysis"
  - BROWSER="platform:OS X 10.8,browserName:iphone,version:6.1,device-orientation:portrait"
  - BROWSER="platform:OS X 10.8,browserName:ipad,version:6.1,device-orientation:portrait"
  - BROWSER="platform:Linux,browserName:android,version:4.0,device-type:tablet,device-orientation:portrait"
  - BROWSER="platform:Windows 7,browserName:firefox,version:25"
  - BROWSER="platform:Windows 7,browserName:chrome,version:31"
  - BROWSER="platform:Windows 8.1,browserName:internet explorer,version:11"
  - BROWSER="platform:Windows 7,browserName:internet explorer,version:10"
  - BROWSER="platform:Windows 7,browserName:internet explorer,version:9"
  - BROWSER="platform:Windows 7,browserName:internet explorer,version:8"
  - BROWSER="platform:Windows 7,browserName:opera,version:12"
  - BROWSER="platform:OS X 10.8,browserName:safari,version:6"
